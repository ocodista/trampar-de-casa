# Auto Email Sender Documentation

The Auto Email Sender project is a collection of microservices designed to streamline the process of sending emails. Each microservice serves a specific purpose, contributing to an efficient and organized email delivery system. The project utilizes various technologies such as Supabase, Redis, React Email, and RabbitMQ to achieve its goals.

## Microservices

### Roles Renderer

The Roles Renderer microservice is responsible for rendering roles or permissions within the email content. This ensures that the email recipients can clearly understand their assigned roles and associated privileges.

### Roles Validator

The Roles Validator microservice validates the assigned roles or permissions before sending emails. It performs checks to ensure that the roles continue valid.

### Roles Assigner

The Roles Assigner microservice manages the assignment of roles to users. It provides functionality to assign specific roles to users based on certain criteria or business logic.

### Email Composer

The Email Composer microservice is responsible for creating and formatting the content of emails. It allows you to dynamically generate email templates, insert placeholders for personalized information, and customize the email's appearance.

### Email Pre-Render

The Email Pre-Render microservice takes care of pre-rendering the email templates generated by the Email Composer. This step enhances the performance of the email delivery process by reducing the rendering workload when sending a large volume of emails.

### Email Sender

The Email Sender microservice is the core component responsible for sending out the pre-rendered emails. It interacts with the other microservices to retrieve the finalized email content and recipient information. The Email Sender uses RabbitMQ to manage the email sending queue, ensuring efficient and reliable email delivery.

## Technologies Used

Supabase: Supabase is utilized for managing user information, roles, and permissions. It provides a secure and scalable database solution.

- **Redis**: Redis serves as a caching mechanism to improve the performance of data retrieval and processing within the microservices.

- **React Email**: React Email is employed for generating dynamic and visually appealing email templates.

- **RabbitMQ**: RabbitMQ is used for message queuing and ensures orderly and reliable email sending across the microservices.

## How use

Here we will delve into the practical aspects of orchestrating a group of microservices

### Flux

The `auto-email-sender` is a group of microservices focused on sending opening emails. Some services in this group require other services to have been run before, as exemplified below:

- `roles-validator` requires `roles-renderer`.
- `email-pre-render` requires `roles-assigner`.
- `email-composer` requires both `roles-validator` and `email-pre-render`.
- `email-sender` requires `email-composer`.

You can initiate these services by running `roles-assigner`:

```sh
docker-compose -f auto-email-sender-compose.yml up -d roles-assigner
```

After this, you can run `email-pre-renderer`:

```sh
docker-compose -f auto-email-sender-compose.yml up -d email-pre-renderer
```

Next, you should run the `email-composer`:

```sh
docker-compose -f auto-email-sender-compose.yml up -d roles-renderer &&
docker-compose -f auto-email-sender-compose.yml up -d roles-validator &&
docker-compose -f auto-email-sender-compose.yml up -d email-composer
```

Finally, after completing the previous steps, you can send the emails using the `email-sender` service:

```sh
docker-compose -f auto-email-sender-compose.yml up -d email-sender
```

The visual flux is this:
![image](https://github.com/ocodista/trampar-de-casa/assets/68869379/20a8287e-b6e2-4811-843f-657da3e2ffae)

#### Observations

The **Blue** card is collateral service for run the main service(**Green**). I explain better [here](#flux).

### Prerequisites:

Before you begin, ensure you have the following prerequisites installed on your system:

1. **Docker and Docker Compose:** Make sure you have Docker and Docker Compose installed. You can download and install them from the official Docker website.

### Steps to Run the Services:

1. **Start the Microservices:**

   Run the following commands in the terminal, one by one, to start the microservices in the desired order:

   a. Start the `roles-renderer` service:

   ```sh
   docker-compose -f auto-email-sender-compose.yml up -d roles-renderer
   ```

   b. Start the `roles-assigner` service:

   ```sh
   docker-compose -f auto-email-sender-compose.yml up -d roles-assigner
   ```

   c. Start the `email-pre-renderer` service:

   ```sh
   docker-compose -f auto-email-sender-compose.yml up -d email-pre-renderer
   ```

   d. Start the `email-composer` service:

   ```sh
   docker-compose -f auto-email-sender-compose.yml up -d email-composer
   ```

   e. Start the `email-sender` service:

   ```sh
   docker-compose -f auto-email-sender-compose.yml up -d email-sender
   ```

2. **Stop and Remove Containers:**

   When you are done using the services, you can stop and remove the containers by running the following command:

   ```sh
   docker-compose -f auto-email-sender-compose.yml down
   ```
